<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pnet.Module package &mdash; pNet 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=292eb321"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pnet.Report package" href="pnet.Report.html" />
    <link rel="prev" title="pnet.Basic package" href="pnet.Basic.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pNet
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">pnet</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pnet.html">pnet package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="pnet.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="pnet.html#module-pnet">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Tutorials and Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pNet</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="modules.html">pnet</a></li>
          <li class="breadcrumb-item"><a href="pnet.html">pnet package</a></li>
      <li class="breadcrumb-item active">pnet.Module package</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pnet-module-package">
<h1>pnet.Module package<a class="headerlink" href="#pnet-module-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-pnet.Module.Data_Input">
<span id="pnet-module-data-input-module"></span><h2>pnet.Module.Data_Input module<a class="headerlink" href="#module-pnet.Module.Data_Input" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.check_data_type_format">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">check_data_type_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataFormat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#check_data_type_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.check_data_type_format" title="Link to this definition"></a></dt>
<dd><p>Check setting for dataType and dataFormat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, ‘Surface-Volume’</p></li>
<li><p><strong>dataFormat</strong> – ‘HCP Surface (<em>.cifti, *.mat)’, ‘MGH Surface (</em>.mgh)’, ‘MGZ Surface (<em>.mgz)’, ‘Volume (</em>.nii, <em>.nii.gz, *.mat)’, ‘HCP Surface-Volume (</em>.cifti)’, ‘HCP Volume (<a href="#id1"><span class="problematic" id="id2">*</span></a>.cifti)’, ‘FreeSurfer’</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 10/18/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.check_template_type_format">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">check_template_type_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templateFormat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#check_template_type_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.check_template_type_format" title="Link to this definition"></a></dt>
<dd><p>Check setting for dataType and templateFormat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, ‘Surface-Volume’</p></li>
<li><p><strong>templateFormat</strong> – ‘HCP’, ‘FreeSurfer’, ‘3D Matrix’</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 10/10/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.compute_brain_surface">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">compute_brain_surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_surfL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskL</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskR</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfL_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Surface'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templateFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HCP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#compute_brain_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.compute_brain_surface" title="Link to this definition"></a></dt>
<dd><p>Prepare a brain surface variable to store surface shape (vertices and faces), and brain masks for useful vertices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_surfL</strong> – file that stores the surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR</strong> – file that stores the surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>file_maskL</strong> – file that stores the mask information of the left hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_maskR</strong> – file that stores the mask information of the right hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_surfL_inflated</strong> – file that stores the inflated surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR_inflated</strong> – file that stores the inflated surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>maskValue</strong> – 0 or 1, 0 means 0s in mask files are useful vertices, otherwise vice versa. maskValue=0 for medial wall in HCP data, and maskValue=1 for brain masks</p></li>
<li><p><strong>dataType</strong> – ‘Surface’</p></li>
<li><p><strong>templateFormat</strong> – ‘HCP’, ‘FreeSurfer’, ‘3D Matrix’</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Brain_Surface: a structure with keys Data_Type, Data_Format, Shape (including L and R), Shape_Inflated (if used), Mask (including L and R)</p>
</dd>
</dl>
<p>Yuncong Ma, 12/4/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.compute_brain_template">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">compute_brain_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templateFormat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_mask_vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_overlayImage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfL_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#compute_brain_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.compute_brain_template" title="Link to this definition"></a></dt>
<dd><p>Prepare a brain surface variable to store surface shape (vertices and faces), and brain masks for useful vertices</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, ‘Surface-Volume’</p></li>
<li><p><strong>templateFormat</strong> – ‘HCP’, ‘FreeSurfer’, ‘3D Matrix’</p></li>
<li><p><strong>file_surfL</strong> – file that stores the surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR</strong> – file that stores the surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>file_maskL</strong> – file that stores the mask information of the left hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_maskR</strong> – file that stores the mask information of the right hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_surfL_inflated</strong> – file that stores the inflated surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR_inflated</strong> – file that stores the inflated surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>file_mask_vol</strong> – file of a mask file for volume-based data type</p></li>
<li><p><strong>file_overlayImage</strong> – file of a background image for visualizing volume-based results</p></li>
<li><p><strong>maskValue</strong> – 0 or 1, 0 means 0s in mask files are useful vertices, otherwise vice versa. maskValue=0 for medial wall in HCP data, and maskValue=1 for brain masks</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Brain_Template: a structure with keys Data_Type, Data_Format, Shape (including L and R), Shape_Inflated (if used), Mask (including L and R) for surface type
a structure with keys Data_Type, Data_Format, Mask, Overlay_Image</p>
</dd>
</dl>
<p>Yuncong Ma, 12/4/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_brain_template">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_brain_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_Brain_Template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_brain_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_brain_template" title="Link to this definition"></a></dt>
<dd><p>Load a brain template file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_Brain_Template</strong> – directory of the brain_template file, in json format. Python cannot read the MATLAB version</p></li>
<li><p><strong>logFile</strong> – directory of a log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Brain_Template: nested dictionary storing information and matrices of brain template. Matrices are converted to np.ndarray</p>
</dd>
</dl>
<p>Yuncong Ma, 12/4/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_fmri_scan">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_fmri_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_scan_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataFormat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nTPoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Reshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Brain_Mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Concatenation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_fmri_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_fmri_scan" title="Link to this definition"></a></dt>
<dd><p>Updated on 07/28/2024: return imaging data header  FY
Updated on 08/01/2024: add number of time points to be sampled
Load one or multiple fMRI scans, and concatenate them into a single 2D matrix along the time dimension
Optional normalization can be added for each scan before concatenation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_scan_list</strong> – Directory of a single txt file storing fMRI file directories, or a directory of a single scan file</p></li>
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, ‘Surface-Volume’</p></li>
<li><p><strong>dataFormat</strong> – ‘HCP Surface (<em>.cifti, *.mat)’, ‘MGH Surface (</em>.mgh)’, ‘MGZ Surface (<em>.mgz)’, ‘Volume (</em>.nii, <em>.nii.gz, *.mat)’, ‘HCP Surface-Volume (</em>.cifti)’, ‘HCP Volume (<a href="#id3"><span class="problematic" id="id4">*</span></a>.cifti)’</p></li>
<li><p><strong>Reshape</strong> – False or True, whether to reshape 4D volume-based fMRI data to 2D</p></li>
<li><p><strong>Brain_Mask</strong> – None or a brain mask [X Y Z]</p></li>
<li><p><strong>Normalization</strong> – False, ‘vp-vmax’</p></li>
<li><p><strong>Concatenation</strong> – True, False</p></li>
<li><p><strong>logFile</strong> – a log file to save the output</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data: a 2D or 4D NumPy array [dim_time dim_space]</p>
</dd>
</dl>
<p>By Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_json_setting">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_json_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_setting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_json_setting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_json_setting" title="Link to this definition"></a></dt>
<dd><p>Load setting variable or others in a json file, also support gzip</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_setting</strong> – Directory of a json setting file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Setting</p>
</dd>
</dl>
<p>By Yuncong Ma, 10/11/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_matlab_array">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_matlab_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_matlab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_matlab_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_matlab_array" title="Link to this definition"></a></dt>
<dd><p>Load a single matlab variable with variable name into np array
This support both matrix and cell vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_matlab</strong> – string</p></li>
<li><p><strong>variable_name</strong> – string</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data as nparray</p>
</dd>
</dl>
<p>By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_matlab_single_array">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_matlab_single_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_matlab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_matlab_single_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_matlab_single_array" title="Link to this definition"></a></dt>
<dd><p>Load a matlab file with only one variable stored
This support both matrix and cell vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_matlab</strong> – string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data as nparray</p>
</dd>
</dl>
<p>By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_matlab_single_variable">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_matlab_single_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_matlab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_matlab_single_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_matlab_single_variable" title="Link to this definition"></a></dt>
<dd><p>Load a matlab file with only one variable stored
This support both matrix and cell vector</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_matlab</strong> – string</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data as its original format</p>
</dd>
</dl>
<p>By Yuncong Ma, 9/24/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.load_txt_list">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">load_txt_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_txt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#load_txt_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.load_txt_list" title="Link to this definition"></a></dt>
<dd><p>Read a txt file containing rows of strings
This code can read large txt files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file_txt</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list, ndarray of strings</p>
</dd>
</dl>
<p>Yuncong Ma, 12/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.ndarray_list">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">ndarray_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_digit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#ndarray_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.ndarray_list" title="Link to this definition"></a></dt>
<dd><p>Convert a numpy array to a list with digits truncation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – np.ndarray, 1D or 2D matrix</p></li>
<li><p><strong>n_digit</strong> – digits reserved</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.normalize_data">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">normalize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vmax'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#normalize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.normalize_data" title="Link to this definition"></a></dt>
<dd><p>Normalize data by algorithm and normalization settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – data in 2D matrix [dim_time, dim_space]</p></li>
<li><p><strong>algorithm</strong> – ‘z’ ‘gp’ ‘vp’</p></li>
<li><p><strong>normalization</strong> – ‘n2’ ‘n1’ ‘rn1’ ‘g’ ‘vmax’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data</p>
</dd>
</dl>
<p>Consistent to MATLAB function normalize_data(X, algorithm, normalization)
‘vp’ is to shift each vector to all non-negative
‘vmax’ is to normalize each vector by its max value</p>
<p>By Yuncong Ma, 12/12/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.output_FN">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">output_FN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_brain_template</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Volume</span> <span class="pre">(*.nii,</span> <span class="pre">*.nii.gz,</span> <span class="pre">*.mat)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cheader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nheader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#output_FN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.output_FN" title="Link to this definition"></a></dt>
<dd><p>Modified on 07/28/2024 with header information by FY
Output FN results in a format matching the input fMRI files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FN</strong> – FN matrix in 2D for surface or surface-volume, 4D for volume, or file directory of a saved FN in .mat, or a tuple of file directories</p></li>
<li><p><strong>file_output</strong> – str when FN is ndarray, None when FN is str or tuple of str</p></li>
<li><p><strong>file_brain_template</strong> – directory of a brain template file matching pNet requirement</p></li>
<li><p><strong>dataFormat</strong> – ‘HCP Surface (<em>.cifti, *.mat)’, ‘MGH Surface (</em>.mgh)’, ‘MGZ Surface (<em>.mgz)’, ‘Volume (</em>.nii, <a href="#id5"><span class="problematic" id="id6">*</span></a>.nii.gz, <a href="#id7"><span class="problematic" id="id8">*</span></a>.mat)’,</p></li>
<li><p><strong>logFile</strong> – a str</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 10/18/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.print_description_scan_info">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">print_description_scan_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#print_description_scan_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.print_description_scan_info" title="Link to this definition"></a></dt>
<dd><p>Print the description of scan info</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logFile</strong> – a string of directory</p>
</dd>
</dl>
<p>Yuncong Ma, 9/28/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.print_log">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">print_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#print_log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.print_log" title="Link to this definition"></a></dt>
<dd><p>print out message in terminal or logfiles</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>message</strong> – A string</p></li>
<li><p><strong>logFile</strong> – None or a directory of a log file</p></li>
<li><p><strong>style</strong> – ‘a’, ‘w’, ‘w+’ or others used for function open</p></li>
<li><p><strong>stop</strong> – False or True, if True, the code execution will be stopped</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 10/2/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.reshape_FN">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">reshape_FN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Brain_Mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Volume_Order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#reshape_FN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.reshape_FN" title="Link to this definition"></a></dt>
<dd><p>reshape_fmri_data(scan_data: np.ndarray, dataType: str, Brain_Mask: np.ndarray, logFile=None)
If dataType is ‘Volume’
Reshape 4D FNs [X Y Z dim_time] or [X Y Z] into 2D matrix [dim_time dim_space], extracting voxels in Brain_Mask
Reshape 2D FNs back to 4D for storage and visualization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>FN</strong> – 4D 3D, or 2D matrix [X Y Z K] [dim_space K]</p></li>
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, or ‘Surface-Volume’</p></li>
<li><p><strong>Brain_Mask</strong> – 3D matrix</p></li>
<li><p><strong>Volume_Order</strong> – index order in the volume</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reshaped_FN: 2D matrix if input is 4D, vice versa</p>
</dd>
</dl>
<p>Yuncong Ma, 11/19/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.reshape_fmri_data">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">reshape_fmri_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Brain_Mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#reshape_fmri_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.reshape_fmri_data" title="Link to this definition"></a></dt>
<dd><p>Reshape 4D volume fMRI data [X Y Z dim_time] into 2D matrix [dim_time dim_space]
Reshape 2D fMRI data back to 4D volume type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_data</strong> – 4D or 2D matrix [X Y Z dim_time] [dim_time dim_space]</p></li>
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, or ‘Surface-Volume’</p></li>
<li><p><strong>Brain_Mask</strong> – 3D matrix</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>reshaped_data: 2D matrix if input is 4D, vice versa</p>
</dd>
</dl>
<p>Yuncong Ma, 10/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.save_brain_template">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">save_brain_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_dataInput</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Brain_Template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#save_brain_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.save_brain_template" title="Link to this definition"></a></dt>
<dd><p>Save the Brain_Template.mat and Brain_Template.json.zip</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_dataInput</strong> – the directory of the Data Input folder</p></li>
<li><p><strong>Brain_Template</strong> – a structure created by function compute_brain_template</p></li>
<li><p><strong>logFile</strong> – ‘Automatic’, None, or a file directory</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 1/10/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.set_data_precision">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">set_data_precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#set_data_precision"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.set_data_precision" title="Link to this definition"></a></dt>
<dd><p>Set the data format and eps
Support single, float32, double, float64</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_precision</strong> – ‘float32’ or ‘float64’ in python, ‘single’ or ‘double’ in MATLAB</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>np_float, np_eps</p>
</dd>
</dl>
<p>By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.set_data_precision_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">set_data_precision_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_precision</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#set_data_precision_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.set_data_precision_torch" title="Link to this definition"></a></dt>
<dd><p>Set the data format and eps
Support single, float32, double, float64</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data_precision</strong> – ‘float32’ or ‘float64’ in python, ‘single’ or ‘double’ in MATLAB</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>torch_float, torch_eps</p>
</dd>
</dl>
<p>By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.setup_brain_template">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">setup_brain_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_dataInput</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_Brain_Template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Surface'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templateFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HCP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_maskR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_mask_vol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_overlayImage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskValue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfL_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_surfR_inflated</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Automatic'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#setup_brain_template"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.setup_brain_template" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_dataInput</strong> – the directory of the Data Input folder</p></li>
<li><p><strong>file_Brain_Template</strong> – file directory or the content of a brain template</p></li>
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’, ‘Surface-Volume’</p></li>
<li><p><strong>templateFormat</strong> – ‘HCP’, ‘FreeSurfer’, ‘3D Matrix’</p></li>
<li><p><strong>file_surfL</strong> – file that stores the surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR</strong> – file that stores the surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>file_maskL</strong> – file that stores the mask information of the left hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_maskR</strong> – file that stores the mask information of the right hemisphere, a 1D 0-1 vector</p></li>
<li><p><strong>file_surfL_inflated</strong> – file that stores the inflated surface shape information of the left hemisphere, including vertices and faces</p></li>
<li><p><strong>file_surfR_inflated</strong> – file that stores the inflated surface shape information of the right hemisphere, including vertices and faces</p></li>
<li><p><strong>file_mask_vol</strong> – file of a mask file for volume-based data type</p></li>
<li><p><strong>file_overlayImage</strong> – file of a background image for visualizing volume-based results</p></li>
<li><p><strong>maskValue</strong> – 0 or 1, 0 means 0s in mask files are useful vertices, otherwise vice versa. maskValue=0 for medial wall in HCP data, and maskValue=1 for brain masks</p></li>
<li><p><strong>logFile</strong> – ‘Automatic’, None, or a txt formatted file directory</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 2/12/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.setup_cifti_volume">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">setup_cifti_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_cifti</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#setup_cifti_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.setup_cifti_volume" title="Link to this definition"></a></dt>
<dd><p>setup a nifti file for the volume parts in CIFTI</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_cifti</strong> – a CIFTI file ending with .dtseries.nii</p></li>
<li><p><strong>file_output</strong> – a NIFTI file ending with .nii or .nii.gz, it stores index order starting from 1</p></li>
<li><p><strong>logFile</strong> – a string</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 10/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.setup_result_folder">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">setup_result_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#setup_result_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.setup_result_folder" title="Link to this definition"></a></dt>
<dd><p>Setup sub-folders in the pNet results folder to store setting and results
Including, Data_Input, FN_Computation, Group_FN, Personalized_FN, Quality_Control, Statistics</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dir_pnet_dataInput, dir_pnet_FNC, dir_pnet_gFN, dir_pnet_pFN, dir_pnet_QC, dir_pnet_STAT</p>
</dd>
</dl>
<p>Yuncong Ma, 9/29/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.setup_scan_info">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">setup_scan_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_dataInput</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_scan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_subject_ID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_subject_folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#setup_scan_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.setup_scan_info" title="Link to this definition"></a></dt>
<dd><p>Set up a few txt files for labeling scans
file_scan contains the directories of all fMRI scans
file_subject_ID contains the subject ID information for each corresponding fMRI scans in file_scan
file_subject_folder contains the sub-folder names for each corresponding fMRI scans in file_scan, in order to store results for each fMRI scan or combined scans
file_Group_ID contains the group ID for each corresponding fMRI scans in file_scan, in order to do desired sampling based on the group information</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_dataInput</strong> – directory of the Data_Input folder or a directory to save Scan_List.txt, Subject_ID.txt, Subject_Folder.txt and Group_ID.txt</p></li>
<li><p><strong>dataType</strong> – ‘Surface’, ‘Volume’</p></li>
<li><p><strong>dataFormat</strong> – ‘HCP Surface (<em>.cifti, *.mat)’, ‘MGH Surface (</em>.mgh)’, ‘MGZ Surface (<em>.mgz)’, or ‘Volume (</em>.nii, <a href="#id9"><span class="problematic" id="id10">*</span></a>.nii.gz, <a href="#id11"><span class="problematic" id="id12">*</span></a>.mat)’</p></li>
<li><p><strong>file_scan</strong> – a txt file that stores directories of all fMRI scans</p></li>
<li><p><strong>file_subject_ID</strong> – a txt file that store subject ID information corresponding to fMRI scan in file_scan</p></li>
<li><p><strong>file_subject_folder</strong> – a txt file that store subject folder names corresponding to fMRI scans in file_scan</p></li>
<li><p><strong>file_group_ID</strong> – a txt file that store group information corresponding to fMRI scan in file_scan</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>logFile</strong> – None, ‘Automatic’, or a file directory, for a txt formatted log file</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 11/30/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Data_Input.write_json_setting">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Data_Input.</span></span><span class="sig-name descname"><span class="pre">write_json_setting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">setting</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_setting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Data_Input.html#write_json_setting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Data_Input.write_json_setting" title="Link to this definition"></a></dt>
<dd><p>Write setting parameter in json format, also support gzip</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>setting</strong> – a json based variable</p></li>
<li><p><strong>file_setting</strong> – Directory of a json setting file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>none</p>
</dd>
</dl>
<p>By Yuncong Ma, 10/9/2023</p>
</dd></dl>

</section>
<section id="module-pnet.Module.FN_Computation">
<span id="pnet-module-fn-computation-module"></span><h2>pnet.Module.FN_Computation module<a class="headerlink" href="#module-pnet.Module.FN_Computation" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.bootstrap_scan">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">bootstrap_scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_scan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_subject_ID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_subject_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combineScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplingMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Subject'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#bootstrap_scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.bootstrap_scan" title="Link to this definition"></a></dt>
<dd><p>prepare bootstrapped scan file lists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_output</strong> – directory of a folder to store bootstrapped files</p></li>
<li><p><strong>file_scan</strong> – a txt file that stores directories of all fMRI scans</p></li>
<li><p><strong>file_subject_ID</strong> – a txt file that store subject ID information corresponding to fMRI scan in file_scan</p></li>
<li><p><strong>file_subject_folder</strong> – a txt file that store subject folder names corresponding to fMRI scans in file_scan</p></li>
<li><p><strong>file_group_ID</strong> – a txt file that store group information corresponding to fMRI scan in file_scan</p></li>
<li><p><strong>combineScan</strong> – 0 or 1, whether to combine multiple fMRI scans for each subject</p></li>
<li><p><strong>samplingMethod</strong> – ‘Subject’ or ‘Group_Subject’. Uniform sampling based subject ID, or group and then subject ID</p></li>
<li><p><strong>sampleSize</strong> – number of subjects selected for each bootstrapping run</p></li>
<li><p><strong>nBS</strong> – number of runs for bootstrap</p></li>
<li><p><strong>logFile</strong> – directory of a txt file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 10/2/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.check_gFN">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">check_gFN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gFN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SR-NMF'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#check_gFN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.check_gFN" title="Link to this definition"></a></dt>
<dd><p>Check the values in gFNs to ensure compatibility to the desired FN model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gFN</strong> – group level FNs, 2D matrix for surface type [V K], 4D matrix for volume type [X Y Z K], where K is the number of FNs</p></li>
<li><p><strong>method</strong> – ‘SR-NMF’</p></li>
<li><p><strong>logFile</strong> – directory of the log file</p></li>
</ul>
</dd>
</dl>
<p>Yuncong Ma, 9/27/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.compute_gNb">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">compute_gNb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Brain_Template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#compute_gNb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.compute_gNb" title="Link to this definition"></a></dt>
<dd><p>Prepare a graph neighborhood variable, using indices as its sparse representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Brain_Template</strong> – a structure variable with keys ‘Data_Type’, ‘Template_Format’, ‘Shape’, ‘Brain_Mask’.
If Brain_Template.Data_Type is ‘Surface’, Shape contains L and R, with vertices and faces as sub keys. Brain_Mask contains L and R.
If Brain_Template.Data_Type is ‘Volume’, Shape is None, Brain_Mask is a 3D 0-1 matrix, Overlay_Image is a 3D matrix
If Brain_Template.Data_Type is ‘Surface-Volume’, It includes fields from both ‘Surface’ and ‘Volume’, ‘Brain_Mask’ is renamed to be ‘Surface_Mask’ and ‘Volume_Mask’</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gNb: a 2D matrix [N, 2], which labels the non-zero elements in a graph. Index starts from 1</p>
</dd>
</dl>
<p>Yuncong Ma, 11/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.construct_Laplacian_gNb">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">construct_Laplacian_gNb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gNb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#construct_Laplacian_gNb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.construct_Laplacian_gNb" title="Link to this definition"></a></dt>
<dd><p>construct Laplacian matrices for Laplacian spatial regularization term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>dim_space</strong> – dimension of space (number of voxels or vertices)</p></li>
<li><p><strong>vxI</strong> – 0 or 1, flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>X</strong> – fMRI data, a 2D matrix, [dim_time, dim_space]</p></li>
<li><p><strong>alphaL</strong> – internal hyper parameter for Laplacian regularization term</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for Laplacian matrix W</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>L, W, D: sparse 2D matrices [dim_space, dim_space]</p>
</dd>
</dl>
<p>Yuncong Ma, 9/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.data_fitting_error">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">data_fitting_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaVU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dVordU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#data_fitting_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.data_fitting_error" title="Link to this definition"></a></dt>
<dd><p>Calculate the datat fitting of X’=UV’ with terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 2D matrix, [Space, Time]</p></li>
<li><p><strong>U</strong> – 2D matrix, [Time, k]</p></li>
<li><p><strong>V</strong> – 2D matrix, [Space, k]</p></li>
<li><p><strong>deltaVU</strong> – 0</p></li>
<li><p><strong>dVordU</strong> – 1</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting_Error</p>
</dd>
</dl>
<p>Consistent to MATLAB function fitting_initialize_u(X, U, V, deltaVU, dVordU, dataPrecision)
By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.gFN_NMF">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">gFN_NMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gNb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_pFN_NMF.log'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#gFN_NMF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.gFN_NMF" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>gFN_NMF(Data, K, gNb, maxIter=1000, minIter=30, error=1e-8, normW=1,</dt><dd><p>Alpha=2, Beta=30, alphaS=0, alphaL=0, vxI=0, ard=0, eta=0, nRepeat=5, dataPrecision=’double’, logFile=’Log_pFN_NMF.log’)</p>
</dd>
</dl>
<p>Compute group-level FNs using NMF method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> – 2D matrix [dim_time, dim_space], recommend to normalize each fMRI scan before concatenate them along the time dimension</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>init</strong> – ‘nndsvda’: NNDSVD with zeros filled with the average of X (better when sparsity is not desired)  #updated on 08/03/2024
‘random’: non-negative random matrices, scaled with: sqrt(X.mean() / n_components)
‘nndsvd’: Nonnegative Double Singular Value Decomposition (NNDSVD) initialization (better for sparseness)
‘nndsvdar’ NNDSVD with zeros filled with small random values (generally faster, less accurate alternative to NNDSVDa for when sparsity is not desired)</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>nRepeat</strong> – Any positive integer, the number of repetition to avoid poor initialization</p></li>
<li><p><strong>dataPrecision</strong> – ‘single’ or ‘float32’, ‘double’ or ‘float64’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gFN, 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 11/27/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.gFN_fusion_NCut">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">gFN_fusion_NCut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gFN_BS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NCut_MaxTrial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#gFN_fusion_NCut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.gFN_fusion_NCut" title="Link to this definition"></a></dt>
<dd><p>Fuses FN results to generate representative group-level FNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gFN_BS</strong> – FNs obtained from bootstrapping method, FNs are concatenated along the K dimension</p></li>
<li><p><strong>K</strong> – Number of FNs, not the total number of FNs obtained from bootstrapping</p></li>
<li><p><strong>NCut_MaxTrial</strong> – Max number trials for NCut method</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gFNs, 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 10/2/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.initialize_u">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">initialize_u</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#initialize_u"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.initialize_u" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – data, 2D matrix [dim_time, dim_space]</p></li>
<li><p><strong>U0</strong> – initial temporal component, 2D matrix [dim_time, k]</p></li>
<li><p><strong>V0</strong> – initial spatial component, 2D matrix [dim_space, k]</p></li>
<li><p><strong>error</strong> – data fitting error</p></li>
<li><p><strong>maxIter</strong> – maximum iteration</p></li>
<li><p><strong>minIter</strong> – minimum iteration</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient</p></li>
<li><p><strong>initConv</strong> – 0 or 1, flag for convergence</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U_final: temporal components of FNs, a 2D matrix [dim_time, K]</p>
</dd>
</dl>
<p>Consistent to MATLAB function initialize_u(X, U0, V0, error, maxIter, minIter, meanFitRatio, initConv, dataPrecision)
By Yuncong Ma, 9/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.mat_corr">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">mat_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#mat_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.mat_corr" title="Link to this definition"></a></dt>
<dd><p>Perform corr as in MATLAB, pair-wise Pearson correlation between columns in X and Y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 1D or 2D matrix</p></li>
<li><p><strong>Y</strong> – 1D or 2D matrix, or None</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
</dl>
<p>X and Y have the same number of rows
:return: Corr</p>
<p>Note: this method will use memory as it concatenates X and Y along column direction.
By Yuncong Ma, 9/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.normalize_data">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">normalize_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#normalize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.normalize_data" title="Link to this definition"></a></dt>
<dd><p>Normalize data by algorithm and normalization settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – data in 2D matrix [dim_time, dim_space], recommend to use reference mode to save memory</p></li>
<li><p><strong>algorithm</strong> – ‘z’ ‘gp’ ‘vp’</p></li>
<li><p><strong>normalization</strong> – ‘n2’ ‘n1’ ‘rn1’ ‘g’ ‘vmax’</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data</p>
</dd>
</dl>
<p>Consistent to MATLAB function normalize_data(X, algorithm, normalization, dataPrecision)
By Yuncong Ma, 9/8/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.normalize_u_v">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">normalize_u_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NormV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#normalize_u_v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.normalize_u_v" title="Link to this definition"></a></dt>
<dd><p>Normalize U and V with terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> – 2D matrix, [Time, k]</p></li>
<li><p><strong>V</strong> – 2D matrix, [Space, k]</p></li>
<li><p><strong>NormV</strong> – 1 or 0</p></li>
<li><p><strong>Norm</strong> – 1 or 2</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U, V</p>
</dd>
</dl>
<p>Consistent to MATLAB function normalize_u_v(U, V, NormV, Norm, dataPrecision)
By Yuncong Ma, 9/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.pFN_NMF">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">pFN_NMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gFN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gNb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_pFN_NMF.log'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#pFN_NMF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.pFN_NMF" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>pFN_NMF(Data, gFN, gNb, maxIter=1000, minIter=30,</dt><dd><p>meanFitRatio=0.1, error=1e-4, normW=1,
Alpha=2, Beta=30, alphaS=2, alphaL=10, initConv=1, ard=0, eta=0,
dataPrecision=’double’, logFile=’Log_pFN_NMF.log’)</p>
</dd>
</dl>
<p>Compute personalized FNs by spatially-regularized NMF method with group FNs as initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> – 2D matrix [dim_time, dim_space]. Data will be formatted to Tensor and normalized.</p></li>
<li><p><strong>gFN</strong> – group level FNs 2D matrix [dim_space, K], K is the number of functional networks. gFN will be cloned</p></li>
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient, used for the initialization of U when using group initialized V</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – 0 or 1, flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>initConv</strong> – flag for convergence of initialization of U</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>dataPrecision</strong> – ‘single’ or ‘float32’, ‘double’ or ‘float64’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U and V. U is the temporal components of pFNs, a 2D matrix [dim_time, K], and V is the spatial components of pFNs, a 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 12/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.robust_normalize_V">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">robust_normalize_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#robust_normalize_V"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.robust_normalize_V" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.run_FN_Computation">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">run_FN_Computation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#run_FN_Computation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.run_FN_Computation" title="Link to this definition"></a></dt>
<dd><p>run the FN Computation module with settings ready in Data_Input and FN_Computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p>
</dd>
</dl>
<p>Yuncong Ma, 1/11/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.setup_SR_NMF">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">setup_SR_NMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_gFN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplingMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Subject'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nTPoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2000,</span> <span class="pre">500)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Computation_Mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CPU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_Thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#setup_SR_NMF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.setup_SR_NMF" title="Link to this definition"></a></dt>
<dd><p>Setup SR-NMF parameters to compute gFNs and pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>file_gFN</strong> – directory of a precomputed gFN in .mat format</p></li>
<li><p><strong>init</strong> – ‘nndsvda’: NNDSVD with zeros filled with the average of X (better when sparsity is not desired)  #updated on 08/03/2024
‘random’: non-negative random matrices, scaled with: sqrt(X.mean() / n_components)
‘nndsvd’: Nonnegative Double Singular Value Decomposition (NNDSVD) initialization (better for sparseness)
‘nndsvdar’ NNDSVD with zeros filled with small random values (generally faster, less accurate alternative to NNDSVDa for when spars</p></li>
<li><p><strong>samplingMethod</strong> – ‘Subject’ or ‘Group_Subject’. Uniform sampling based subject ID, or group and then subject ID</p></li>
<li><p><strong>sampleSize</strong> – ‘Automatic’ or integer number, number of subjects selected for each bootstrapping run</p></li>
<li><p><strong>nBS</strong> – ‘Automatic’ or integer number, number of runs for bootstrap</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient, used for the initialization of U when using group initialized V</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>nRepeat</strong> – Any positive integer, the number of repetition to avoid poor initialization</p></li>
<li><p><strong>Parallel</strong> – False or True, whether to enable parallel computation</p></li>
<li><p><strong>Computation_Mode</strong> – ‘CPU’</p></li>
<li><p><strong>N_Thread</strong> – positive integers, used for parallel computation</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
<li><p><strong>outputFormat</strong> – ‘MAT’, ‘Both’, ‘MAT’ is to save results in FN.mat and TC.mat for functional networks and time courses respectively. ‘Both’ is for both matlab format and fMRI input file format</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>setting: a structure</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation.setup_pFN_folder">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation.</span></span><span class="sig-name descname"><span class="pre">setup_pFN_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation.html#setup_pFN_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation.setup_pFN_folder" title="Link to this definition"></a></dt>
<dd><p>Setup sub-folders in Personalized_FN to</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>list_subject_folder_unique: unique subject folder array for getting sub-folders in Personalized_FN</p>
</dd>
</dl>
<p>Yuncong Ma, 9/25/2023</p>
</dd></dl>

</section>
<section id="module-pnet.Module.FN_Computation_torch">
<span id="pnet-module-fn-computation-torch-module"></span><h2>pnet.Module.FN_Computation_torch module<a class="headerlink" href="#module-pnet.Module.FN_Computation_torch" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation_torch.run_FN_Computation_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation_torch.</span></span><span class="sig-name descname"><span class="pre">run_FN_Computation_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation_torch.html#run_FN_Computation_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation_torch.run_FN_Computation_torch" title="Link to this definition"></a></dt>
<dd><p>run the FN Computation module with settings ready in Data_Input and FN_Computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p>
</dd>
</dl>
<p>Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation_torch.run_FN_computation_torch_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation_torch.</span></span><span class="sig-name descname"><span class="pre">run_FN_computation_torch_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/FN_Computation_torch.html#run_FN_computation_torch_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation_torch.run_FN_computation_torch_cluster" title="Link to this definition"></a></dt>
<dd><p>run the FN Computation module in cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p>
</dd>
</dl>
<p>Yuncong Ma, 6/5/2024</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation_torch.setup_FN_Computation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pnet.Module.FN_Computation_torch.</span></span><span class="sig-name descname"><span class="pre">setup_FN_Computation</span></span><a class="reference internal" href="_modules/pnet/Module/FN_Computation_torch.html#setup_FN_Computation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.FN_Computation_torch.setup_FN_Computation" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation_torch.setup_FN_Computation.setup_GIG_ICA">
<span class="sig-name descname"><span class="pre">setup_GIG_ICA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_gFN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nemda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EGv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3745672075</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ErChuPai</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6366197723</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Computation_Mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CPU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_Thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MAT'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pnet.Module.FN_Computation_torch.setup_FN_Computation.setup_GIG_ICA" title="Link to this definition"></a></dt>
<dd><p>Setup GIG-ICA parameters for obtaining pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>file_gFN</strong> – directory of a precomputed gFN in .mat format</p></li>
</ul>
</dd>
</dl>
<p># model parameters
:param maxIter: maximum iteration number for multiplicative update
:param a: weighting to the own pFN
:param Nemda: step size for iteration
:param ftol: tolerance for the objective function
:param error: error tolerance for w to obtain pFN
:param EGv: constant
:param ErChuPai: constant</p>
<p># computation resource settings
:param Parallel: False or True, whether to enable parallel computation
:param Computation_Mode: ‘CPU’
:param N_Thread: positive integers, used for parallel computation
:param dataPrecision: ‘double’ or ‘single’
:param outputFormat: ‘MAT’, ‘Both’, ‘MAT’ is to save results in FN.mat and TC.mat for functional networks and time courses respectively. ‘Both’ is for both matlab format and fMRI input file format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>setting: a structure</p>
</dd>
</dl>
<p>Yuncong Ma, 2/12/2024</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pnet.Module.FN_Computation_torch.setup_FN_Computation.setup_SR_NMF">
<span class="sig-name descname"><span class="pre">setup_SR_NMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_gFN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplingMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Subject'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nTPoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2000,</span> <span class="pre">500)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Computation_Mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CPU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_Thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Both'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pnet.Module.FN_Computation_torch.setup_FN_Computation.setup_SR_NMF" title="Link to this definition"></a></dt>
<dd><p>Setup SR-NMF parameters to compute gFNs and pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>file_gFN</strong> – directory of a precomputed gFN in .mat format</p></li>
</ul>
</dd>
</dl>
<p># model parameters
:param init: ‘nndsvda’: NNDSVD with zeros filled with the average of X (better when sparsity is not desired)  #updated on 08/03/2024</p>
<blockquote>
<div><p>‘random’: non-negative random matrices, scaled with: sqrt(X.mean() / n_components)
‘nndsvd’: Nonnegative Double Singular Value Decomposition (NNDSVD) initialization (better for sparseness)
‘nndsvdar’ NNDSVD with zeros filled with small random values (generally faster, less accurate alternative to NNDSVDa for when spars</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samplingMethod</strong> – ‘Subject’ or ‘Group_Subject’. Uniform sampling based subject ID, or group and then subject ID</p></li>
<li><p><strong>sampleSize</strong> – ‘Automatic’ or integer number, number of subjects selected for each bootstrapping run</p></li>
<li><p><strong>nBS</strong> – ‘Automatic’ or integer number, number of runs for bootstrap</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient, used for the initialization of U when using group initialized V</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>nRepeat</strong> – Any positive integer, the number of repetition to avoid poor initialization</p></li>
</ul>
</dd>
</dl>
<p># computation resource settings
:param Parallel: False or True, whether to enable parallel computation
:param Computation_Mode: ‘CPU’
:param N_Thread: positive integers, used for parallel computation
:param dataPrecision: ‘double’ or ‘single’
:param outputFormat: ‘MAT’, ‘Both’, ‘MAT’ is to save results in FN.mat and TC.mat for functional networks and time courses respectively. ‘Both’ is for both matlab format and fMRI input file format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>setting: a structure</p>
</dd>
</dl>
<p>Yuncong Ma, 2/5/2024</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-pnet.Module.GIG_ICA">
<span id="pnet-module-gig-ica-module"></span><h2>pnet.Module.GIG_ICA module<a class="headerlink" href="#module-pnet.Module.GIG_ICA" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.GIG_ICA.GIG_ICA_neg_entropy">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.GIG_ICA.</span></span><span class="sig-name descname"><span class="pre">GIG_ICA_neg_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/GIG_ICA.html#GIG_ICA_neg_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.GIG_ICA.GIG_ICA_neg_entropy" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.GIG_ICA.pFN_GIG_ICA_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.GIG_ICA.</span></span><span class="sig-name descname"><span class="pre">pFN_GIG_ICA_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/GIG_ICA.html#pFN_GIG_ICA_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.GIG_ICA.pFN_GIG_ICA_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the GIG-ICA for pFNs in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p></li>
<li><p><strong>jobID</strong> – jobID starting from 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.GIG_ICA.pFN_GIG_ICA_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.GIG_ICA.</span></span><span class="sig-name descname"><span class="pre">pFN_GIG_ICA_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gFN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nemda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EGv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3745672075</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ErChuPai</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6366197723</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_pFN_GIG_ICA.log'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/GIG_ICA.html#pFN_GIG_ICA_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.GIG_ICA.pFN_GIG_ICA_torch" title="Link to this definition"></a></dt>
<dd><p>Compute personalized FNs using GIG-ICA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> – 2D matrix [dim_time, dim_space], numpy.ndarray or torch.Tensor. Data will be formatted to Tensor and normalized.</p></li>
<li><p><strong>gFN</strong> – group level FNs 2D matrix [dim_space, K], K is the number of functional networks, numpy.ndarray or torch.Tensor. gFN will be cloned</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update</p></li>
<li><p><strong>a</strong> – weighting to the own pFN</p></li>
<li><p><strong>Nemda</strong> – step size for iteration</p></li>
<li><p><strong>ftol</strong> – tolerance for the objective function</p></li>
<li><p><strong>error</strong> – error tolerance for w to obtain pFN</p></li>
<li><p><strong>EGv</strong> – constant</p></li>
<li><p><strong>ErChuPai</strong> – constant</p></li>
<li><p><strong>dataPrecision</strong> – ‘single’ or ‘float32’, ‘double’ or ‘float64’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TC and FN. TC is the temporal components of pFNs, a 2D matrix [dim_time, K], and FN is the spatial components of pFNs, a 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.GIG_ICA.setup_GIG_ICA">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.GIG_ICA.</span></span><span class="sig-name descname"><span class="pre">setup_GIG_ICA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_gFN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nemda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ftol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.02</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">EGv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3745672075</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ErChuPai</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6366197723</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Computation_Mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CPU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_Thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MAT'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/GIG_ICA.html#setup_GIG_ICA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.GIG_ICA.setup_GIG_ICA" title="Link to this definition"></a></dt>
<dd><p>Setup GIG-ICA parameters for obtaining pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>file_gFN</strong> – directory of a precomputed gFN in .mat format</p></li>
</ul>
</dd>
</dl>
<p># model parameters
:param maxIter: maximum iteration number for multiplicative update
:param a: weighting to the own pFN
:param Nemda: step size for iteration
:param ftol: tolerance for the objective function
:param error: error tolerance for w to obtain pFN
:param EGv: constant
:param ErChuPai: constant</p>
<p># computation resource settings
:param Parallel: False or True, whether to enable parallel computation
:param Computation_Mode: ‘CPU’
:param N_Thread: positive integers, used for parallel computation
:param dataPrecision: ‘double’ or ‘single’
:param outputFormat: ‘MAT’, ‘Both’, ‘MAT’ is to save results in FN.mat and TC.mat for functional networks and time courses respectively. ‘Both’ is for both matlab format and fMRI input file format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>setting: a structure</p>
</dd>
</dl>
<p>Yuncong Ma, 2/12/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.GIG_ICA.update_model_parameter">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.GIG_ICA.</span></span><span class="sig-name descname"><span class="pre">update_model_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="k"><span class="pre">False</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FN_model_parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/GIG_ICA.html#update_model_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.GIG_ICA.update_model_parameter" title="Link to this definition"></a></dt>
<dd><p>Update the model parameters in setup_SR_NMF for GIG-ICA</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong></p></li>
<li><p><strong>setting</strong> – obtained from setup_GIG_ICA</p></li>
<li><p><strong>FN_model_parameter</strong> – None or a dict containing model parameters listed in setup_GIG_ICA</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 2/12/2024</p>
</dd></dl>

</section>
<section id="module-pnet.Module.Quality_Control">
<span id="pnet-module-quality-control-module"></span><h2>pnet.Module.Quality_Control module<a class="headerlink" href="#module-pnet.Module.Quality_Control" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control.compute_quality_control">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control.</span></span><span class="sig-name descname"><span class="pre">compute_quality_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gFN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pFN</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control.html#compute_quality_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control.compute_quality_control" title="Link to this definition"></a></dt>
<dd><p>Compute quality control measurements, including spatial correspondence and functional coherence
The spatial correspondence ensures one-to-one match between gFNs and pFNs
The functional coherence ensures that pFNs gives better data fitting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_data</strong> – 2D matrix, [dim_time, dim_space]</p></li>
<li><p><strong>gFN</strong> – 2D matrix, [dim_space, K], K is the number of FNs</p></li>
<li><p><strong>pFN</strong> – 2D matrix, [dim_space, K], K is the number of FNs</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
<li><p><strong>logFile</strong> – None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spatial_Correspondence, Delta_Spatial_Correspondence, Miss_Match, Functional_Coherence, Functional_Coherence_Control</p>
</dd>
</dl>
<p>Spatial correspondence is a 2D symmetric matrix [K, K], which measures the spatial correlation between gFNs and pFNs
Delta_Spatial_Correspondence is a vector [K, ], which measures minimum difference of spatial correlation between matched and unmatched gFNs and pFNs
Miss_Match is a 2D matrix [N, 2]. Each row notes a pair of miss-matched gFN and pFN.
Functional_Coherence is a vector [K, ], which measures the weighted average correlation between node-wise fMRI signal in scan_data and time series of pFNs
Functional_Coherence_Control is a vector [K, ], which measures the weighted average correlation between node-wise fMRI signal in scan_data and time series of gFNs</p>
<p>Yuncong Ma, 12/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control.print_description_QC">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control.</span></span><span class="sig-name descname"><span class="pre">print_description_QC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control.html#print_description_QC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control.print_description_QC" title="Link to this definition"></a></dt>
<dd><p>Print the description of quality control module</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logFile</strong></p>
</dd>
</dl>
<p>Yuncong Ma, 9/28/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control.run_quality_control">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control.</span></span><span class="sig-name descname"><span class="pre">run_quality_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control.html#run_quality_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control.run_quality_control" title="Link to this definition"></a></dt>
<dd><p>Run the quality control module, which computes spatial correspondence and functional coherence
The quality control result folder has consistent sub-folder organization as Personalized_FN
Quality control results of each scan or combined scans are stored into sub-folders
A single matlab file named Result.mat stores all quantitative values, including
Spatial_Correspondence: spatial correspondence between pFNs and gFNs
Delta_Spatial_Correspondence: the difference between spatial correspondence of matched pFNs-gFNs and miss-matched pFNs-gFNS
Miss_Match: A 2D matrix, [N, 2], each row specifies which pFN is miss matched to a different gFN
Functional_Coherence: weighted average of Pearson correlation between time series of pFNs and all nodes
Functional_Coherence_Control: weighted average of Pearson correlation between time series of gFNs and all nodes
A final report in txt format saved in the root directory of quality control folder
It summaries the number of miss matched FNs for each failed scan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – the directory of pNet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 12/19/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control.visualize_quality_control">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control.</span></span><span class="sig-name descname"><span class="pre">visualize_quality_control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control.html#visualize_quality_control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control.visualize_quality_control" title="Link to this definition"></a></dt>
<dd><p>Visualize the results of quality control for all scans in the dataset
:param dir_pnet_result: directory of the pNet result folder
:return: None</p>
<p>Yuncong Ma, 2/14/2024</p>
</dd></dl>

</section>
<section id="module-pnet.Module.Quality_Control_torch">
<span id="pnet-module-quality-control-torch-module"></span><h2>pnet.Module.Quality_Control_torch module<a class="headerlink" href="#module-pnet.Module.Quality_Control_torch" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control_torch.compute_quality_control_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control_torch.</span></span><span class="sig-name descname"><span class="pre">compute_quality_control_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gFN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pFN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control_torch.html#compute_quality_control_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control_torch.compute_quality_control_torch" title="Link to this definition"></a></dt>
<dd><p>Compute quality control measurements, including spatial correspondence and functional coherence
The spatial correspondence ensures one-to-one match between gFNs and pFNs
The functional coherence ensures that pFNs gives better data fitting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan_data</strong> – 2D matrix, [dim_time, dim_space], np.ndarray or torch.Tensor</p></li>
<li><p><strong>gFN</strong> – 2D matrix, [dim_space, K], K is the number of FNs, np.ndarray or torch.Tensor</p></li>
<li><p><strong>pFN</strong> – 2D matrix, [dim_space, K], K is the number of FNs, np.ndarray or torch.Tensor</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
<li><p><strong>logFile</strong> – None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spatial_Correspondence, Delta_Spatial_Correspondence, Miss_Match, Functional_Coherence, Functional_Coherence_Control</p>
</dd>
</dl>
<p>Outputs are numpy.ndarray
Spatial correspondence is a 2D symmetric matrix [K, K], which measures the spatial correlation between gFNs and pFNs
Delta_Spatial_Correspondence is a vector [K, ], which measures minimum difference of spatial correlation between matched and unmatched gFNs and pFNs
Miss_Match is a 2D matrix [N, 2]. Each row notes a pair of miss-matched gFN and pFN.
Functional_Coherence is a vector [K, ], which measures the weighted average correlation between node-wise fMRI signal in scan_data and time series of pFNs
Functional_Coherence_Control is a vector [K, ], which measures the weighted average correlation between node-wise fMRI signal in scan_data and time series of gFNs</p>
<p>Yuncong Ma, 2/9/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control_torch.compute_quality_control_torch_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control_torch.</span></span><span class="sig-name descname"><span class="pre">compute_quality_control_torch_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control_torch.html#compute_quality_control_torch_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control_torch.compute_quality_control_torch_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the QC in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p></li>
<li><p><strong>jobID</strong> – jobID starting from 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 12/1/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control_torch.run_quality_control_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control_torch.</span></span><span class="sig-name descname"><span class="pre">run_quality_control_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control_torch.html#run_quality_control_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control_torch.run_quality_control_torch" title="Link to this definition"></a></dt>
<dd><p>Run the quality control module, which computes spatial correspondence and functional coherence
The quality control result folder has consistent sub-folder organization as Personalized_FN
Quality control results of each scan or combined scans are stored into sub-folders
A single matlab file named Result.mat stores all quantitative values, including
Spatial_Correspondence: spatial correspondence between pFNs and gFNs
Delta_Spatial_Correspondence: the difference between spatial correspondence of matched pFNs-gFNs and miss-matched pFNs-gFNS
Miss_Match: A 2D matrix, [N, 2], each row specifies which pFN is miss matched to a different gFN
Functional_Coherence: weighted average of Pearson correlation between time series of pFNs and all nodes
Functional_Coherence_Control: weighted average of Pearson correlation between time series of gFNs and all nodes
A final report in txt format saved in the root directory of quality control folder
It summaries the number of miss matched FNs for each failed scan</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – the directory of pNet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 12/20/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Quality_Control_torch.run_quality_control_torch_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Quality_Control_torch.</span></span><span class="sig-name descname"><span class="pre">run_quality_control_torch_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Quality_Control_torch.html#run_quality_control_torch_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Quality_Control_torch.run_quality_control_torch_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the quality control module in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – the directory of pNet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 6/5/2024</p>
</dd></dl>

</section>
<section id="module-pnet.Module.SR_NMF">
<span id="pnet-module-sr-nmf-module"></span><h2>pnet.Module.SR_NMF module<a class="headerlink" href="#module-pnet.Module.SR_NMF" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.compute_gNb">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">compute_gNb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Brain_Template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#compute_gNb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.compute_gNb" title="Link to this definition"></a></dt>
<dd><p>Prepare a graph neighborhood variable, using indices as its sparse representation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Brain_Template</strong> – a structure variable with keys ‘Data_Type’, ‘Template_Format’, ‘Shape’, ‘Brain_Mask’.
If Brain_Template.Data_Type is ‘Surface’, Shape contains L and R, with vertices and faces as sub keys. Brain_Mask contains L and R.
If Brain_Template.Data_Type is ‘Volume’, Shape is None, Brain_Mask is a 3D 0-1 matrix, Overlay_Image is a 3D matrix
If Brain_Template.Data_Type is ‘Surface-Volume’, It includes fields from both ‘Surface’ and ‘Volume’, ‘Brain_Mask’ is renamed to be ‘Surface_Mask’ and ‘Volume_Mask’</p></li>
<li><p><strong>logFile</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gNb: a 2D matrix [N, 2], which labels the non-zero elements in a graph. Index starts from 1</p>
</dd>
</dl>
<p>Yuncong Ma, 11/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.construct_Laplacian_gNb">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">construct_Laplacian_gNb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gNb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">np.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#construct_Laplacian_gNb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.construct_Laplacian_gNb" title="Link to this definition"></a></dt>
<dd><p>construct Laplacian matrices for Laplacian spatial regularization term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>dim_space</strong> – dimension of space (number of voxels or vertices)</p></li>
<li><p><strong>vxI</strong> – 0 or 1, flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>X</strong> – fMRI data, a 2D matrix, [dim_time, dim_space]</p></li>
<li><p><strong>alphaL</strong> – internal hyper parameter for Laplacian regularization term</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for Laplacian matrix W</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>L, W, D: sparse 2D matrices [dim_space, dim_space]</p>
</dd>
</dl>
<p>Yuncong Ma, 9/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.construct_Laplacian_gNb_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">construct_Laplacian_gNb_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gNb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#construct_Laplacian_gNb_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.construct_Laplacian_gNb_torch" title="Link to this definition"></a></dt>
<dd><p>Construct Laplacian matrices for Laplacian spatial regularization term</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>dim_space</strong> – dimension of space (number of voxels or vertices)</p></li>
<li><p><strong>vxI</strong> – 0 or 1, flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>X</strong> – fMRI data, a 2D matrix, [dim_time, dim_space]</p></li>
<li><p><strong>alphaL</strong> – internal hyper parameter for Laplacian regularization term</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for Laplacian matrix W</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>L, W, D: sparse 2D matrices [dim_space, dim_space]</p>
</dd>
</dl>
<p>Yuncong Ma, 9/7/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.data_fitting_error_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">data_fitting_error_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaVU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dVordU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#data_fitting_error_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.data_fitting_error_torch" title="Link to this definition"></a></dt>
<dd><p>Calculate the datat fitting of X’=UV’ with terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – 2D matrix, [Space, Time]</p></li>
<li><p><strong>U</strong> – 2D matrix, [Time, k]</p></li>
<li><p><strong>V</strong> – 2D matrix, [Space, k]</p></li>
<li><p><strong>deltaVU</strong> – 0</p></li>
<li><p><strong>dVordU</strong> – 1</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fitting_Error</p>
</dd>
</dl>
<p>Consistent to MATLAB function fitting_initialize_u(X, U, V, deltaVU, dVordU, dataPrecision)
By Yuncong Ma, 9/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.fuse_FN_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">fuse_FN_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#fuse_FN_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.fuse_FN_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the NCut to fuse FNs in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.gFN_SR_NMF_boostrapping_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">gFN_SR_NMF_boostrapping_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#gFN_SR_NMF_boostrapping_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.gFN_SR_NMF_boostrapping_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the NMF for bootstraping in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p></li>
<li><p><strong>jobID</strong> – jobID starting from 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.gFN_SR_NMF_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">gFN_SR_NMF_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gNb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_gFN_NMF.log'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#gFN_SR_NMF_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.gFN_SR_NMF_torch" title="Link to this definition"></a></dt>
<dd><p>Compute group-level FNs using NMF method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> – 2D matrix [dim_time, dim_space], numpy.ndarray or torch.Tensor, recommend to normalize each fMRI scan before concatenate them along the time dimension</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>init</strong> – ‘nndsvda’: NNDSVD with zeros filled with the average of X (better when sparsity is not desired)  #updated on 08/03/2024
‘random’: non-negative random matrices, scaled with: sqrt(X.mean() / n_components)
‘nndsvd’: Nonnegative Double Singular Value Decomposition (NNDSVD) initialization (better for sparseness)
‘nndsvdar’ NNDSVD with zeros filled with small random values (generally faster, less accurate alternative to NNDSVDa for when sparsity is not desired)</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>nRepeat</strong> – Any positive integer, the number of repetition to avoid poor initialization</p></li>
<li><p><strong>dataPrecision</strong> – ‘single’ or ‘float32’, ‘double’ or ‘float64’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gFN, 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.gFN_fusion_NCut_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">gFN_fusion_NCut_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gFN_BS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NCut_MaxTrial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_gFN_fusion_NCut'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#gFN_fusion_NCut_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.gFN_fusion_NCut_torch" title="Link to this definition"></a></dt>
<dd><p>Fuses FN results to generate representative group-level FNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gFN_BS</strong> – FNs obtained from bootstrapping method, FNs are concatenated along the K dimension</p></li>
<li><p><strong>K</strong> – Number of FNs, not the total number of FNs obtained from bootstrapping</p></li>
<li><p><strong>NCut_MaxTrial</strong> – Max number trials for NCut method</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>gFNs, 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 10/2/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.initialize_u_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">initialize_u_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">U0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#initialize_u_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.initialize_u_torch" title="Link to this definition"></a></dt>
<dd><p>Initialize U with fixed V, used for pFN_NMF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – data, 2D matrix [dim_time, dim_space], numpy.ndarray or torch.Tensor</p></li>
<li><p><strong>U0</strong> – initial temporal component, 2D matrix [dim_time, k], numpy.ndarray or torch.Tensor</p></li>
<li><p><strong>V0</strong> – initial spatial component, 2D matrix [dim_space, k], numpy.ndarray or torch.Tensor</p></li>
<li><p><strong>error</strong> – data fitting error</p></li>
<li><p><strong>maxIter</strong> – maximum iteration</p></li>
<li><p><strong>minIter</strong> – minimum iteration</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient</p></li>
<li><p><strong>initConv</strong> – 0 or 1, flag for convergence</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U_final: temporal components of FNs, a 2D matrix [dim_time, K]</p>
</dd>
</dl>
<p>Consistent to MATLAB function initialize_u(X, U0, V0, error, maxIter, minIter, meanFitRatio, initConv, dataPrecision)
By Yuncong Ma, 9/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.normalize_data_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">normalize_data_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vmax'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#normalize_data_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.normalize_data_torch" title="Link to this definition"></a></dt>
<dd><p>Normalize data by algorithm and normalization settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – data in 2D matrix [dim_time, dim_space], numpy.ndarray or torch.Tensor, recommend to use reference mode to save memory</p></li>
<li><p><strong>algorithm</strong> – ‘z’ ‘gp’ ‘vp’</p></li>
<li><p><strong>normalization</strong> – ‘n2’ ‘n1’ ‘rn1’ ‘g’ ‘vmax’</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>data</p>
</dd>
</dl>
<p>Consistent to MATLAB function normalize_data(X, algorithm, normalization, dataPrecision)
By Yuncong Ma, 12/12/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.normalize_u_v_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">normalize_u_v_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">U</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NormV</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#normalize_u_v_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.normalize_u_v_torch" title="Link to this definition"></a></dt>
<dd><p>Normalize U and V with terms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> – 2D matrix, [Time, k]</p></li>
<li><p><strong>V</strong> – 2D matrix, [Space, k]</p></li>
<li><p><strong>NormV</strong> – 1 or 0</p></li>
<li><p><strong>Norm</strong> – 1 or 2</p></li>
<li><p><strong>dataPrecision</strong> – ‘double’ or ‘single’</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U, V</p>
</dd>
</dl>
<p>Consistent to MATLAB function normalize_u_v(U, V, NormV, Norm, dataPrecision)
By Yuncong Ma, 9/5/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.pFN_SR_NMF_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">pFN_SR_NMF_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#pFN_SR_NMF_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.pFN_SR_NMF_cluster" title="Link to this definition"></a></dt>
<dd><p>Run the SR-NMF for pFNs in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p></li>
<li><p><strong>jobID</strong> – jobID starting from 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 2/2/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.pFN_SR_NMF_torch">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">pFN_SR_NMF_torch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gFN</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gNb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initConv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logFile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Log_pFN_NMF.log'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#pFN_SR_NMF_torch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.pFN_SR_NMF_torch" title="Link to this definition"></a></dt>
<dd><p>Compute personalized FNs by spatially-regularized NMF method with group FNs as initialization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Data</strong> – 2D matrix [dim_time, dim_space], numpy.ndarray or torch.Tensor. Data will be formatted to Tensor and normalized.</p></li>
<li><p><strong>gFN</strong> – group level FNs 2D matrix [dim_space, K], K is the number of functional networks, numpy.ndarray or torch.Tensor. gFN will be cloned</p></li>
<li><p><strong>gNb</strong> – graph neighborhood, a 2D matrix [N, 2] storing rows and columns of non-zero elements</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient, used for the initialization of U when using group initialized V</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – 0 or 1, flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>initConv</strong> – flag for convergence of initialization of U</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>dataPrecision</strong> – ‘single’ or ‘float32’, ‘double’ or ‘float64’</p></li>
<li><p><strong>logFile</strong> – str, directory of a txt log file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>U and V. U is the temporal components of pFNs, a 2D matrix [dim_time, K], and V is the spatial components of pFNs, a 2D matrix [dim_space, K]</p>
</dd>
</dl>
<p>Yuncong Ma, 12/13/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.robust_normalize_V">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">robust_normalize_V</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#robust_normalize_V"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.robust_normalize_V" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.setup_SR_NMF">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">setup_SR_NMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Combine_Scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_gFN</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'random'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplingMethod</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Subject'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleSize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Automatic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nBS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nTPoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">99999</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2000,</span> <span class="pre">500)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minIter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">meanFitRatio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphaL</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vxI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nRepeat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Parallel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Computation_Mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CPU'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_Thread</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataPrecision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'double'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputFormat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Both'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#setup_SR_NMF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.setup_SR_NMF" title="Link to this definition"></a></dt>
<dd><p>Setup SR-NMF parameters to compute gFNs and pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pNet result folder</p></li>
<li><p><strong>K</strong> – number of FNs</p></li>
<li><p><strong>Combine_Scan</strong> – False or True, whether to combine multiple scans for the same subject</p></li>
<li><p><strong>file_gFN</strong> – directory of a precomputed gFN in .mat format</p></li>
</ul>
</dd>
</dl>
<p># model parameters
:param init: ‘nndsvda’: NNDSVD with zeros filled with the average of X (better when sparsity is not desired)  #updated on 08/03/2024</p>
<blockquote>
<div><p>‘random’: non-negative random matrices, scaled with: sqrt(X.mean() / n_components)
‘nndsvd’: Nonnegative Double Singular Value Decomposition (NNDSVD) initialization (better for sparseness)
‘nndsvdar’ NNDSVD with zeros filled with small random values (generally faster, less accurate alternative to NNDSVDa for when spars</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samplingMethod</strong> – ‘Subject’ or ‘Group_Subject’. Uniform sampling based subject ID, or group and then subject ID</p></li>
<li><p><strong>sampleSize</strong> – ‘Automatic’ or integer number, number of subjects selected for each bootstrapping run</p></li>
<li><p><strong>nBS</strong> – ‘Automatic’ or integer number, number of runs for bootstrap</p></li>
<li><p><strong>maxIter</strong> – maximum iteration number for multiplicative update, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>minIter</strong> – minimum iteration in case fast convergence, which can be one number or two numbers for gFN and pFN separately</p></li>
<li><p><strong>meanFitRatio</strong> – a 0-1 scaler, exponential moving average coefficient, used for the initialization of U when using group initialized V</p></li>
<li><p><strong>error</strong> – difference of cost function for convergence</p></li>
<li><p><strong>normW</strong> – 1 or 2, normalization method for W used in Laplacian regularization</p></li>
<li><p><strong>Alpha</strong> – hyper parameter for spatial sparsity</p></li>
<li><p><strong>Beta</strong> – hyper parameter for Laplacian sparsity</p></li>
<li><p><strong>alphaS</strong> – internally determined, the coefficient for spatial sparsity based Alpha, data size, K, and gNb</p></li>
<li><p><strong>alphaL</strong> – internally determined, the coefficient for Laplacian sparsity based Beta, data size, K, and gNb</p></li>
<li><p><strong>vxI</strong> – flag for using the temporal correlation between nodes (vertex, voxel)</p></li>
<li><p><strong>ard</strong> – 0 or 1, flat for combining similar clusters</p></li>
<li><p><strong>eta</strong> – a hyper parameter for the ard regularization term</p></li>
<li><p><strong>nRepeat</strong> – Any positive integer, the number of repetition to avoid poor initialization</p></li>
</ul>
</dd>
</dl>
<p># computation resource settings
:param Parallel: False or True, whether to enable parallel computation
:param Computation_Mode: ‘CPU’
:param N_Thread: positive integers, used for parallel computation
:param dataPrecision: ‘double’ or ‘single’
:param outputFormat: ‘MAT’, ‘Both’, ‘MAT’ is to save results in FN.mat and TC.mat for functional networks and time courses respectively. ‘Both’ is for both matlab format and fMRI input file format</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>setting: a structure</p>
</dd>
</dl>
<p>Yuncong Ma, 2/5/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.SR_NMF.update_model_parameter">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.SR_NMF.</span></span><span class="sig-name descname"><span class="pre">update_model_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FN_model_parameter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setting</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/SR_NMF.html#update_model_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.SR_NMF.update_model_parameter" title="Link to this definition"></a></dt>
<dd><p>Update the model parameters in setup_SR_NMF for SR-NMF</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong></p></li>
<li><p><strong>setting</strong> – obtained from setup_SR_NMF</p></li>
<li><p><strong>FN_model_parameter</strong> – None or a dict containing model parameters listed in setup_SR_NMF</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 6/5/2024</p>
</dd></dl>

</section>
<section id="module-pnet.Module.Visualization">
<span id="pnet-module-visualization-module"></span><h2>pnet.Module.Visualization module<a class="headerlink" href="#module-pnet.Module.Visualization" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.assemble_image">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">assemble_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_list_image:</span> <span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output_assembled=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">organization=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval=(50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#assemble_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.assemble_image" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_list_image</strong> – a tuple of image directories or image matrices, images must have the same size</p></li>
<li><p><strong>file_output_assembled</strong> – output file directory, can be None to get image matrix as output</p></li>
<li><p><strong>organization</strong> – number of rows and columns, default is (0, 10) means to set 10 columns with automatic row number</p></li>
<li><p><strong>interval</strong> – (50, 5) in default, meaning the interval is 50 by 5 pixels</p></li>
<li><p><strong>background</strong> – (0, 0, 0) in default, meaning the background color is black</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>image_assembled (M, N, 3) matrix, if file_output_assembled is None</p>
</dd>
</dl>
<p>Yuncong Ma, 11/3/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.brainmap_colorfunction">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">brainmap_colorfunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brain_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_style</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Positive_Only'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_round</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#brainmap_colorfunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.brainmap_colorfunction" title="Link to this definition"></a></dt>
<dd><p>Prepare a colorfunction based a brain_map and other settings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>brain_map</strong> – 1D numpy array</p></li>
<li><p><strong>colorbar_range_style</strong> – ‘Positive_Only’, ‘All_Range’</p></li>
<li><p><strong>colorbar_range_round</strong> – 1, 0, 0.1, 0.01, 10, etc.</p></li>
<li><p><strong>threshold</strong> – 0 for automatic setting, or a number</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>color_function, color_range, threshold_value</p>
</dd>
</dl>
<p>Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.color_theme">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">color_theme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theme</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">darker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#color_theme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.color_theme" title="Link to this definition"></a></dt>
<dd><p>Get predefined color functions based color theme and additional parameters.
This function matches to Yuncong Ma’s MATLAB function fColor_Theme</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theme</strong> – ‘Seed_Map’, ‘Seed_Map_3_Positive’</p></li>
<li><p><strong>parameter</strong> – parameters used for that specific theme. It is a tuple or scalar containing of 1-4 real numbers</p></li>
<li><p><strong>darker</strong> – False, or a real number in (0, 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>color_function, a 2D ndarray matrix [N, 4], with first column as values, and the rest three as RGB colors</p>
</dd>
</dl>
<p>Examples:
color_function = color_theme(‘Seed_Map’,(min_CC,Threshold,max_CC))
color_function = color_theme(‘Seed_Map_2’,(min_CC,max_CC))
color_function = color_theme(‘Seed_Map_3’,(min_CC,max_CC))
color_function = color_theme(‘Seed_Map_Positive’,(min_CC,Threshold,max_CC))
color_function = color_theme(‘Seed_Map_Positive_Only’,(min_CC,Threshold,max_CC))
color_function = color_theme(‘Seed_Map_3_Positive’,(min_CC,max_CC))
color_function = color_theme(‘FC’,max_CC)
color_function = color_theme(‘Atlas’,Max_Index)
color_function = color_theme(‘Gray_Scale’,(Min_Value,Min_Gray,Max_Value,Max_Gray))
color_function = color_theme(‘Rainbow’,(Min_Value,Max_Value))</p>
<p>Yuncong Ma, 12/9/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.colorize">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">colorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#colorize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.colorize" title="Link to this definition"></a></dt>
<dd><p>colorize a 2D value map into a 2D image [X, Y, 3]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value_map</strong></p></li>
<li><p><strong>color_function</strong></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>image_rgb: np.ndarray, np.float32, 0-1</p>
</dd>
</dl>
<p>Yuncong Ma, 11/3/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.compress_image">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">compress_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_compressed_image</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_rgb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(2000,</span> <span class="pre">10000)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#compress_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.compress_image" title="Link to this definition"></a></dt>
<dd><p>Compress an PIL.Image object to a certain size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_compressed_image</strong> – directory of the output image file</p></li>
<li><p><strong>image_rgb</strong> – an Image file or a PIL.Image object</p></li>
<li><p><strong>image_size</strong> – (width, height)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 12/18/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.large_3view_center">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">large_3view_center</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#large_3view_center"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.large_3view_center" title="Link to this definition"></a></dt>
<dd><p>Get the view center for a 3D map, maximizing the content in each view</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weight_map</strong> – a 3D matrix, either 0-1 or weighted</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Center ndarray: [3, 1]</p>
</dd>
</dl>
<p>Yuncong Ma, 2/1/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.merge_mask_LR">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">merge_mask_LR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_LR</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#merge_mask_LR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.merge_mask_LR" title="Link to this definition"></a></dt>
<dd><p>Merge masks of two hemispheres for surface type</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask_LR</strong> – a dict containing ‘L’ and ‘R’, each contains a 1D vector, np.ndarray</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a 1D vector, np.ndarray</p>
</dd>
</dl>
<p>Yuncong Ma, 11/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.merge_mesh_LR">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">merge_mesh_LR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh_LR</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([90,</span> <span class="pre">0,</span> <span class="pre">0])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#merge_mesh_LR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.merge_mesh_LR" title="Link to this definition"></a></dt>
<dd><p>Merge two meshes into one</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh_LR</strong> – a dict containing ‘L’ and ‘R’, in which vertices and faces are stored</p></li>
<li><p><strong>offset</strong> – np.ndarray, 3D vector for the distance between the centers of left and right hemispheres</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mesh, a dict of vertices and faces</p>
</dd>
</dl>
<p>Yuncong Ma, 11/6/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.plot_FN_brain_surface_5view">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_FN_brain_surface_5view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brain_map:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold=99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_organization=(0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_angle=(1.35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere_offset=90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_font_dic={'fontsize':</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'fontweight':</span> <span class="pre">'bold'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_style='Positive_Only'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_scale=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_round=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label='Loading</span> <span class="pre">(%)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size=(10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">50)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi=50</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#plot_FN_brain_surface_5view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.plot_FN_brain_surface_5view" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.plot_FN_brain_surface_volume_7view">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_FN_brain_surface_volume_7view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brain_map:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold=99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_organization=(0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_angle=1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hemisphere_offset=90</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_center='max_value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation='nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_font_dic={'fontsize':</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'fontweight':</span> <span class="pre">'bold'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_style='Positive_Only'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_scale=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_round=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label='Loading</span> <span class="pre">(%)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size=(10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">50)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi=50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_setting=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#plot_FN_brain_surface_volume_7view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.plot_FN_brain_surface_volume_7view" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.plot_FN_brain_volume_3view">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_FN_brain_volume_3view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brain_map:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_template</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold=99.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_center='max_value'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_organization=(0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_title=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_font_dic={'fontsize':</span> <span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'fontweight':</span> <span class="pre">'bold'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation='nearest'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_style='Positive_Only'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_scale=100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_range_round=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar_label='Loading</span> <span class="pre">(%)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size=(10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">40)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi=250</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_setting=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#plot_FN_brain_volume_3view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.plot_FN_brain_volume_3view" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.plot_brain_surface">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_brain_surface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">brain_map:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh:</span> <span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function:</span> <span class="pre">~numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_output=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orientation='medial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_angle=1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_color=(0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">brain_color=(0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background=(0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_size=(500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">400)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi=25</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#plot_brain_surface"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.plot_brain_surface" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.plot_voxel_map_3view">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">plot_voxel_map_3view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Anatomy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Voxel_Map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">organization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0,</span> <span class="pre">0,</span> <span class="pre">0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#plot_voxel_map_3view"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.plot_voxel_map_3view" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.prepare_BSPolyData">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">prepare_BSPolyData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#prepare_BSPolyData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.prepare_BSPolyData" title="Link to this definition"></a></dt>
<dd><p>prepare a BSPolyData class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vertices</strong> – 2D matrix [N, 3], N is the number of vertices</p></li>
<li><p><strong>faces</strong> – 2D matrix, [N, 3], N is the number of triangle faces, vertex index starts from 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bspolydata, a data class for using brain space surface plot</p>
</dd>
</dl>
<p>Yuncong Ma, 11/1/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.prepare_color_map">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">prepare_color_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_name=&lt;class</span> <span class="pre">'str'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_function=&lt;class</span> <span class="pre">'numpy.ndarray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N=256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">black_transparent=True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#prepare_color_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.prepare_color_map" title="Link to this definition"></a></dt>
<dd><p>Prepare a color map using color function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map_name</strong> – a color map name for matplotlib.colors.ListedColormap</p></li>
<li><p><strong>color_function</strong> – np.ndarray [N, 4], N is the number of predefined color changing points</p></li>
<li><p><strong>N</strong> – digitized colors</p></li>
<li><p><strong>alpha</strong> – transparency</p></li>
<li><p><strong>black_transparent</strong> – True or False, True is to set black color to transparent</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>cmap: a structure created by matplotlib.colors.ListedColormap</p>
</dd>
</dl>
<p>Yuncong Ma, 10/30/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.run_Visualization">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">run_Visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#run_Visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.run_Visualization" title="Link to this definition"></a></dt>
<dd><p>Run preconfigured visualizations for gFNs and pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of the pnet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 11/15/2023</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.run_Visualization_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">run_Visualization_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#run_Visualization_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.run_Visualization_cluster" title="Link to this definition"></a></dt>
<dd><p>Run preconfigured visualizations for gFNs and pFNs in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of the pnet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 6/5/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.run_gFN_Visualization">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">run_gFN_Visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#run_gFN_Visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.run_gFN_Visualization" title="Link to this definition"></a></dt>
<dd><p>Run preconfigured visualizations for gFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of the pnet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.run_pFN_Visualization">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">run_pFN_Visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#run_pFN_Visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.run_pFN_Visualization" title="Link to this definition"></a></dt>
<dd><p>Run preconfigured visualizations for pFNs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dir_pnet_result</strong> – directory of the pnet result folder</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.run_pFN_Visualization_cluster">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">run_pFN_Visualization_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobID</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#run_pFN_Visualization_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.run_pFN_Visualization_cluster" title="Link to this definition"></a></dt>
<dd><p>Run preconfigured visualizations for pFNs in cluster computation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of the pnet result folder</p></li>
<li><p><strong>jobID</strong> – jobID starting from 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
<p>Yuncong Ma, 2/5/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.setup_Visualization">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">setup_Visualization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_pnet_result</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronized_view</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synchronized_colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#setup_Visualization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.setup_Visualization" title="Link to this definition"></a></dt>
<dd><p>Setup visualization styles, including synchronized display</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_pnet_result</strong> – directory of pNet result folder</p></li>
<li><p><strong>synchronized_view</strong> – True or False, whether to synchronize view centers for volume data between gFNs and pFNs</p></li>
<li><p><strong>synchronized_colorbar</strong> – True or False, whether to synchronize color bar between gFNs and pFNs</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p>Yuncong Ma, 2/8/2024</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pnet.Module.Visualization.setup_colorbar_style">
<span class="sig-prename descclassname"><span class="pre">pnet.Module.Visualization.</span></span><span class="sig-name descname"><span class="pre">setup_colorbar_style</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">FN_Method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pnet/Module/Visualization.html#setup_colorbar_style"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pnet.Module.Visualization.setup_colorbar_style" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-pnet.Module">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pnet.Module" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="pnet.Basic.html" class="btn btn-neutral float-left" title="pnet.Basic package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pnet.Report.html" class="btn btn-neutral float-right" title="pnet.Report package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, pNet developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>